import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,f as l,a as e,b as i,d as a,e as n,r as h,o as p}from"./app-2pbKPq8C.js";const d={};function c(k,s){const t=h("RouteLink");return p(),r("div",null,[s[32]||(s[32]=l('<h1 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting"><span>Troubleshooting</span></a></h1><div class="hint-container note"><p class="hint-container-title">Table of contents</p><ul><li><a href="#why-does-cloudformation-stack-creation-timeout-and-rollback">Why does CloudFormation stack creation timeout and rollback?</a></li><li><a href="#why-does-my-ssh-client-reject-access-to-the-zilla-proxy-instances">Why does my SSH client reject access to the Zilla proxy instances?</a></li><li><a href="#why-does-my-ssh-client-timeout-when-attempting-to-access-the-zilla-proxy-instances">Why does my SSH client timeout when attempting to access the Zilla proxy instances?</a></li><li><a href="#why-does-the-zilla-plus-service-keep-restarting-on-the-zilla-proxy-instances">Why does the <code>zilla-plus</code> service keep restarting on the Zilla proxy instances?</a></li><li><a href="#why-does-my-kafka-client-fail-to-connect-via-zilla-proxy">Why does my Kafka Client fail to connect via Zilla proxy?</a></li></ul></div><h2 id="why-does-cloudformation-stack-creation-timeout-and-rollback" tabindex="-1"><a class="header-anchor" href="#why-does-cloudformation-stack-creation-timeout-and-rollback"><span>Why does CloudFormation stack creation timeout and rollback?</span></a></h2><p>The CloudFormation stack will timeout if the launched instances are unable to call back to CloudFormation via the internet during deployment.</p><p>This can occur if the target VPC has no attached Internet Gateway, or if the main Route Table for the VPC has not been updated to add a default route to the Internet Gateway.</p>',5)),e("p",null,[s[2]||(s[2]=i("Make sure to ")),a(t,{to:"/solutions/how-tos/aws-services/create-vpc.html#attach-the-internet-gateway"},{default:n(()=>s[0]||(s[0]=[i("attach the Internet Gateway")])),_:1}),s[3]||(s[3]=i(" and ")),a(t,{to:"/solutions/how-tos/aws-services/create-vpc.html#route-to-the-internet-gateway"},{default:n(()=>s[1]||(s[1]=[i("route to the Internet Gateway")])),_:1}),s[4]||(s[4]=i(", then try again."))]),s[33]||(s[33]=l('<h2 id="why-does-my-ssh-client-reject-access-to-the-zilla-proxy-instances" tabindex="-1"><a class="header-anchor" href="#why-does-my-ssh-client-reject-access-to-the-zilla-proxy-instances"><span>Why does my SSH client reject access to the Zilla proxy instances?</span></a></h2><p>The SSH client will actively reject unauthorized connection attempts to the Zilla proxies.</p><p>This can occur if you are not using the same Launch Key as specified during CloudFormation stack creation.</p><p>This can occur if you are not using the <code>ec2-user</code> username to login via SSH.</p><p>Try again, making sure to use the same Launch Key as specified during CloudFormation stack creation, and the username <code>ec2-user</code>.</p><h2 id="why-does-my-ssh-client-timeout-when-attempting-to-access-the-zilla-proxy-instances" tabindex="-1"><a class="header-anchor" href="#why-does-my-ssh-client-timeout-when-attempting-to-access-the-zilla-proxy-instances"><span>Why does my SSH client timeout when attempting to access the Zilla proxy instances?</span></a></h2><p>The SSH client will timeout if some or all of the network traffic is being dropped between the launched Zilla proxies and the SSH client.</p><p>This can occur if the target VPC has no attached Internet Gateway, or if the main Route Table for the VPC has not been updated to add a default route to the Internet Gateway.</p>',8)),e("p",null,[s[7]||(s[7]=i("Make sure to ")),a(t,{to:"/solutions/how-tos/aws-services/create-vpc.html#attach-the-internet-gateway"},{default:n(()=>s[5]||(s[5]=[i("attach the Internet Gateway")])),_:1}),s[8]||(s[8]=i(" and ")),a(t,{to:"/solutions/how-tos/aws-services/create-vpc.html#route-to-the-internet-gateway"},{default:n(()=>s[6]||(s[6]=[i("route to the Internet Gateway")])),_:1}),s[9]||(s[9]=i(", then try again."))]),s[34]||(s[34]=e("h2",{id:"why-does-the-zilla-plus-service-keep-restarting-on-the-zilla-proxy-instances",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#why-does-the-zilla-plus-service-keep-restarting-on-the-zilla-proxy-instances"},[e("span",null,[i("Why does the "),e("code",null,"zilla-plus"),i(" service keep restarting on the Zilla proxy instances?")])])],-1)),s[35]||(s[35]=e("p",null,"This can occur if the IAM Role associated with your Zilla proxies has insufficient privileges to use the AWS Services needed by Zilla proxy.",-1)),s[36]||(s[36]=e("p",null,"Check the policies attached to your Zilla proxy instance IAM Role based on the deployment type, then try again.",-1)),e("ul",null,[e("li",null,[s[13]||(s[13]=i("Zilla proxy ")),e("ul",null,[e("li",null,[a(t,{to:"/solutions/how-tos/amazon-msk/secure-public-access/development.html#create-the-zilla-proxy-iam-security-role"},{default:n(()=>s[10]||(s[10]=[i("via SASL/SCRAM")])),_:1})]),e("li",null,[a(t,{to:"/solutions/how-tos/amazon-msk/secure-public-access/production.html#create-the-zilla-proxy-iam-security-role"},{default:n(()=>s[11]||(s[11]=[i("via mTLS")])),_:1})]),e("li",null,[a(t,{to:"/solutions/how-tos/amazon-msk/secure-public-access/production-mutual-tls.html#create-the-zilla-proxy-iam-security-role"},{default:n(()=>s[12]||(s[12]=[i("via Unauthorized access)")])),_:1})])])])]),s[37]||(s[37]=l(`<h2 id="why-does-my-kafka-client-fail-to-connect-via-zilla-proxy" tabindex="-1"><a class="header-anchor" href="#why-does-my-kafka-client-fail-to-connect-via-zilla-proxy"><span>Why does my Kafka Client fail to connect via Zilla proxy?</span></a></h2><p>This can occur if the DNS names are not setup correctly to point to the NLB Load Balancer deployed via a provided CloudFormation template, or if the <code>client.properties</code> file is not configured to use the correct <code>keystore</code> or <code>truststore</code>.</p><p>Make sure your DNS and <code>client.properties</code> are configured correctly, then try again.</p><p>You can verify TCP connectivity using the following command:</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">nc</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> -v</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt; </span><span style="--shiki-light:#098658;--shiki-dark:#B5CEA8;">9094</span></span></code></pre></div><p>The <code>nc</code> output should be as shown below:</p><div class="language-output" data-highlighter="shiki" data-ext="output" data-title="output" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>Connection to &lt;b-1-broker-dns-name&gt; port 9094 [tcp/*] succeeded!</span></span></code></pre></div><p>Also, <code>nc</code> should stay connected.</p><p>You can verify TLS connectivity with client key and signed client certificate using the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">openssl</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> s_client</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-connect &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">:9094</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-servername &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt; </span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;">\\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-cert </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">client.cert</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-key </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">client.key.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10)),e("p",null,[s[17]||(s[17]=i("Note: if you followed ")),a(t,{to:"/solutions/how-tos/aws-services/create-server-certificate-acm.html"},{default:n(()=>s[14]||(s[14]=[i("Create Server Certificate")])),_:1}),s[18]||(s[18]=i(" to create the server certificate instead of ")),a(t,{to:"/solutions/how-tos/aws-services/create-server-certificate-letsencrypt.html"},{default:n(()=>s[15]||(s[15]=[i("Create Server Certificate (LetsEncrypt)")])),_:1}),s[19]||(s[19]=i(", then you will need to ")),a(t,{to:"/solutions/how-tos/aws-services/create-certificate-authority-acm.html#export-the-ca-certificate"},{default:n(()=>s[16]||(s[16]=[i("Export the CA Certificate")])),_:1}),s[20]||(s[20]=i(" and have ")),s[21]||(s[21]=e("code",null,"openssl",-1)),s[22]||(s[22]=i(" trust the exported CA certificate."))]),s[38]||(s[38]=l(`<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">openssl</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> s_client</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-connect &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">:9094</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-servername &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt; </span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;">\\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-cert </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">client.cert</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-key </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">client.key.pem</span></span>
<span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">-CAfile</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> Certificate.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>openssl</code> output should be as shown below:</p><div class="language-output" data-highlighter="shiki" data-ext="output" data-title="output" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>...</span></span>
<span class="line"><span>    Verify return code: 0 (ok)</span></span>
<span class="line"><span>---</span></span></code></pre></div><p>Note: if the client-to-proxy TLS handshake is configured correctly, then <code>openssl</code> will not show an error, instead the TLS handshake will complete successfully and stay connected.</p><p>Note: If the backend TLS handshake from proxy-to-msk fails for any reason, then the <code>openssl</code> command will disconnect after handshake without an <code>openssl</code> error code.</p><p>You can verify Kafka connectivity with client key and signed client certificate using the following command:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">kcat</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-L </span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;">\\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-b &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">:9094</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">security.protocol=ssl</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">ssl.certificate.location=client.cert</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">ssl.key.location=client.key.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7)),e("p",null,[s[26]||(s[26]=i("Note: if you followed ")),a(t,{to:"/solutions/how-tos/aws-services/create-server-certificate-acm.html"},{default:n(()=>s[23]||(s[23]=[i("Create Server Certificate")])),_:1}),s[27]||(s[27]=i(" to create the server certificate instead of ")),a(t,{to:"/solutions/how-tos/aws-services/create-server-certificate-letsencrypt.html"},{default:n(()=>s[24]||(s[24]=[i("Create Server Certificate (LetsEncrypt)")])),_:1}),s[28]||(s[28]=i(", then you will need to ")),a(t,{to:"/solutions/how-tos/aws-services/create-certificate-authority-acm.html#export-the-ca-certificate"},{default:n(()=>s[25]||(s[25]=[i("Export the CA Certificate")])),_:1}),s[29]||(s[29]=i(" and have ")),s[30]||(s[30]=e("code",null,"kcat",-1)),s[31]||(s[31]=i(" trust the exported CA certificate."))]),s[39]||(s[39]=l(`<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">kcat</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-L </span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;">\\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-b &lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">b-1-broker-dns-nam</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">e&gt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">:9094</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">security.protocol=ssl</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">ssl.certificate.location=client.cert</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">ssl.key.location=client.key.pem</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">-X </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">ssl.ca.location=Certificate.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>kcat</code> output should show the list of brokers and topics accessible to the client.</p>`,2))])}const g=o(d,[["render",c],["__file","troubleshooting.html.vue"]]),m=JSON.parse('{"path":"/solutions/how-tos/aws-services/troubleshooting.html","title":"Troubleshooting","lang":"en-US","frontmatter":{"description":"Common errors and how to handle them","gitInclude":[],"head":[["meta",{"property":"og:url","content":"https://docs.aklivity.io/zilla-docs/next/solutions/how-tos/aws-services/troubleshooting.html"}],["meta",{"property":"og:site_name","content":"Documentation"}],["meta",{"property":"og:title","content":"Troubleshooting"}],["meta",{"property":"og:description","content":"Common errors and how to handle them"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Troubleshooting\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Why does CloudFormation stack creation timeout and rollback?","slug":"why-does-cloudformation-stack-creation-timeout-and-rollback","link":"#why-does-cloudformation-stack-creation-timeout-and-rollback","children":[]},{"level":2,"title":"Why does my SSH client reject access to the Zilla proxy instances?","slug":"why-does-my-ssh-client-reject-access-to-the-zilla-proxy-instances","link":"#why-does-my-ssh-client-reject-access-to-the-zilla-proxy-instances","children":[]},{"level":2,"title":"Why does my SSH client timeout when attempting to access the Zilla proxy instances?","slug":"why-does-my-ssh-client-timeout-when-attempting-to-access-the-zilla-proxy-instances","link":"#why-does-my-ssh-client-timeout-when-attempting-to-access-the-zilla-proxy-instances","children":[]},{"level":2,"title":"Why does the zilla-plus service keep restarting on the Zilla proxy instances?","slug":"why-does-the-zilla-plus-service-keep-restarting-on-the-zilla-proxy-instances","link":"#why-does-the-zilla-plus-service-keep-restarting-on-the-zilla-proxy-instances","children":[]},{"level":2,"title":"Why does my Kafka Client fail to connect via Zilla proxy?","slug":"why-does-my-kafka-client-fail-to-connect-via-zilla-proxy","link":"#why-does-my-kafka-client-fail-to-connect-via-zilla-proxy","children":[]}],"readingTime":{"minutes":3.06,"words":918},"filePathRelative":"solutions/how-tos/aws-services/troubleshooting.md"}');export{g as comp,m as data};
