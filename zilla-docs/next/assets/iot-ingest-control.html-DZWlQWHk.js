import{_ as u}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,a as i,b as s,d as t,f as r,e as a,r as p,o as g}from"./app-BNYstFbe.js";const m={},y={class:"zilla-plus-badge hint-container info"},v={href:"https://www.aklivity.io/products/zilla-plus",target:"_blank",rel:"noopener noreferrer"},f={class:"hint-container info"},D={class:"hint-container tip"},b={class:"hint-container info"};function C(S,e){const l=p("ZillaPlus"),h=p("RouteLink"),d=p("CodeTabs"),c=p("Tabs");return g(),k("div",null,[e[66]||(e[66]=i("h1",{id:"amazon-msk-iot-ingest-and-control",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#amazon-msk-iot-ingest-and-control"},[i("span",null,"Amazon MSK IoT Ingest and Control")])],-1)),i("p",y,[i("a",v,[e[0]||(e[0]=s("Available in ")),t(l)])]),e[67]||(e[67]=r('<div class="hint-container info"><p class="hint-container-title">Estimated time to complete 10-15 minutes.</p></div><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><p>The <a href="https://aws.amazon.com/marketplace/pp/prodview-jshnzslazfm44" target="_blank" rel="noopener noreferrer">Zilla Plus for Amazon MSK</a> IoT Ingest and Control MQTT Broker lets clients publish messages and subscribe to topics that are proxied to Kafka topics in your Amazon MSK cluster.</p><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><p>Before creating an IoT Ingest and Control MQTT Broker to your Kafka cluster, you will need the following:</p><ul><li>a Kafka cluster configured for SASL/SCRAM authentication</li><li>a custom DNS wildcard domain, for this guide we will use <code>*.example.aklivity.io</code></li><li>a TLS Server Certificate stored in Secrets Manager for your custom DNS wildcard domain</li></ul>',6)),i("div",f,[e[6]||(e[6]=i("p",{class:"hint-container-title"},"Info",-1)),e[7]||(e[7]=i("p",null,"Note the server certificate secret ARN as we will need to reference it from the IoT Ingest and Control CloudFormation template.",-1)),e[8]||(e[8]=i("p",null,[s("Make sure you have selected the desired region, ex: "),i("code",null,"US East (N. Virginia) us-east-1"),s(".")],-1)),i("p",null,[e[2]||(e[2]=s("If you need help creating a TLS Server Certificate you can follow the ")),t(h,{to:"/solutions/how-tos/aws-services/create-server-certificate-letsencrypt.html"},{default:a(()=>e[1]||(e[1]=[s("Create Server Certificate with LetsEncrypt")])),_:1}),e[3]||(e[3]=s(" guide. Use your own custom DNS wildcard domain in place of the example domain ")),e[4]||(e[4]=i("code",null,"*.example.aklivity.io",-1)),e[5]||(e[5]=s("."))])]),e[68]||(e[68]=r('<h3 id="aws-services-used" tabindex="-1"><a class="header-anchor" href="#aws-services-used"><span>AWS services used</span></a></h3><table><thead><tr><th>Service</th><th>Required</th><th>Usage</th><th>Quota</th></tr></thead><tbody><tr><td>Secrets Manager</td><td>Yes</td><td>Startup only</td><td><a href="https://docs.aws.amazon.com/general/latest/gr/asm.html#limits_secrets-manager" target="_blank" rel="noopener noreferrer">Not reached</a></td></tr><tr><td>Certificate Manager</td><td>No<br><br>Private key and certificate can be inline in Secrets Manager instead</td><td>Startup only</td><td><a href="https://docs.aws.amazon.com/general/latest/gr/acm.html#limits_acm" target="_blank" rel="noopener noreferrer">Not reached</a></td></tr><tr><td>Private Certificate Manager</td><td>No<br><br>Private key and certificate can be inline in Secrets Manager instead</td><td>Startup only</td><td><a href="https://docs.aws.amazon.com/general/latest/gr/acm-pca.html#limits_acm-pca" target="_blank" rel="noopener noreferrer">Not reached</a></td></tr></tbody></table><p>Default <a href="https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html" target="_blank" rel="noopener noreferrer">AWS Service Quotas</a> are recommended.</p>',3)),i("div",D,[e[12]||(e[12]=i("p",{class:"hint-container-title"},"Tips",-1)),i("p",null,[e[10]||(e[10]=s("Check out the ")),t(h,{to:"/solutions/how-tos/aws-services/troubleshooting.html"},{default:a(()=>e[9]||(e[9]=[s("Troubleshooting")])),_:1}),e[11]||(e[11]=s(" guide if you run into any issues."))])]),e[69]||(e[69]=i("h2",{id:"create-the-amazon-msk-cluster",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#create-the-amazon-msk-cluster"},[i("span",null,"Create the Amazon MSK cluster")])],-1)),e[70]||(e[70]=i("blockquote",null,[i("p",null,"This creates your MSK cluster in preparation for secure access via the internet.")],-1)),e[71]||(e[71]=i("p",null,"An MSK cluster is needed for secure remote access via the internet. You can skip this step if you have already created an MSK cluster with equivalent configuration.",-1)),i("p",null,[e[14]||(e[14]=s("Follow the ")),t(h,{to:"/solutions/how-tos/aws-services/create-msk-cluster.html"},{default:a(()=>e[13]||(e[13]=[s("Create MSK Cluster")])),_:1}),e[15]||(e[15]=s(" guide to setup the a new MSK cluster. We will use the below resource names to reference the AWS resources needed in this guide."))]),e[72]||(e[72]=r(`<ul><li>Cluster Name: <code>my-zilla-iot-msk-cluster</code></li><li>Access control methods: <code>SASL/SCRAM authentication</code></li></ul><p>With a running MSK Cluster you will need to create these topics. You can reference this AWS developer guide for help <a href="https://docs.aws.amazon.com/msk/latest/developerguide/create-topic.html" target="_blank" rel="noopener noreferrer">creating topics</a>.</p><ul><li><p>Topics:</p><ul><li>With cleanup policy &quot;delete&quot; to store MQTT messages:</li></ul><div class="language-text" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>mqtt-messages</span></span></code></pre></div><ul><li>With cleanup policy &quot;compact&quot; to store MQTT retained messages:</li></ul><div class="language-text" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>mqtt-retained</span></span></code></pre></div><ul><li>With cleanup policy &quot;compact&quot; to store MQTT sessions:</li></ul><div class="language-text" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>mqtt-sessions</span></span></code></pre></div></li></ul><h3 id="create-a-secret-with-sasl-scram-authentication-params" tabindex="-1"><a class="header-anchor" href="#create-a-secret-with-sasl-scram-authentication-params"><span>Create a Secret with SASL/SCRAM authentication params</span></a></h3><p>When the MSK cluster is created you will need to follow the <a href="https://docs.aws.amazon.com/msk/latest/developerguide/msk-password.html" target="_blank" rel="noopener noreferrer">Sign-in credentials authentication with AWS Secrets Manager</a> to associate your <code>AmazonMSK_*</code> secret to your cluster. There will be a prompt on the cluster summary page to create a new secret or associate an existing one. For the remainder of this doc we will assume the following values for this secret:</p><ul><li><p>Secret Type: <code>Other type of secret</code></p></li><li><p>Value:</p><ul><li>Plaintext JSON object:</li></ul><div class="language-json" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">  &quot;username&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;alice&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">  &quot;password&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;alice-secret&quot;</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">}</span></span></code></pre></div></li><li><p>Encryption key: <code>&lt;Customer managed key&gt;</code></p></li><li><p>Secret Name: <code>AmazonMSK_access</code></p></li><li><p>Review and store the secret</p></li></ul><div class="hint-container caution"><p class="hint-container-title">Important</p><p>A secret created with the default AWS KMS key cannot be used with an Amazon MSK cluster.</p></div><p>Go to the newly created secret and under <code>Resource permissions</code> &gt; select <code>Edit Permissions</code>. Add the below <code>AWSKafkaResourcePolicy</code> and replace the resource secret name with your SASL/SCRAM auth secret name.</p><div class="language-json" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">  &quot;Version&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;2012-10-17&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">  &quot;Statement&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : [ {</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">    &quot;Sid&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;AWSKafkaResourcePolicy&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">    &quot;Effect&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;Allow&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">    &quot;Principal&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : {</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">      &quot;Service&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;kafka.amazonaws.com&quot;</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">    },</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">    &quot;Action&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;secretsmanager:getSecretValue&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">    &quot;Resource&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;"> : </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;arn:aws:secretsmanager:*:*:secret:&lt;SASL/SCRAM auth secret name&gt;*&quot;</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">  } ]</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">}</span></span></code></pre></div><h2 id="zilla-proxy-aws-resources" tabindex="-1"><a class="header-anchor" href="#zilla-proxy-aws-resources"><span>Zilla proxy AWS resources</span></a></h2>`,10)),i("p",null,[e[16]||(e[16]=s("We need to create the AWS resources necessary to allow access to the IoT Ingest and Control MQTT Broker from the internet, the ")),t(l),e[17]||(e[17]=s(" proxy instances access to Secrets Manager secrets, and SSH access to the instances for troubleshooting."))]),e[73]||(e[73]=i("h3",{id:"create-the-vpc",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#create-the-vpc"},[i("span",null,"Create the VPC")])],-1)),i("blockquote",null,[i("p",null,[e[18]||(e[18]=s("This creates your ")),t(l),e[19]||(e[19]=s(" proxy VPC in preparation for access from an MQTT client."))])]),e[74]||(e[74]=i("p",null,[i("a",{href:"https://docs.aws.amazon.com/vpc/latest/userguide/create-vpc.html#create-vpc-and-other-resources",target:"_blank",rel:"noopener noreferrer"},"Create a VPC plus other VPC resources"),s(" with the below resource names.")],-1)),e[75]||(e[75]=i("ul",null,[i("li",null,[s("Name tag auto-generation: "),i("code",null,"my-zilla-iot-proxy")]),i("li",null,[s("VPC endpoints: "),i("code",null,"none")]),i("li",null,"Create the VPC")],-1)),e[76]||(e[76]=i("h3",{id:"create-the-security-group",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#create-the-security-group"},[i("span",null,"Create the security group")])],-1)),i("blockquote",null,[i("p",null,[e[20]||(e[20]=s("This creates your ")),t(l),e[21]||(e[21]=s(" proxy security group to allow MQTT clients and SSH access."))])]),i("p",null,[e[22]||(e[22]=s("A VPC security group is needed for the ")),t(l),e[23]||(e[23]=s(" proxies when they are launched."))]),i("p",null,[e[24]||(e[24]=s("Follow the ")),e[25]||(e[25]=i("a",{href:"https://console.aws.amazon.com/vpcconsole/home#CreateSecurityGroup:",target:"_blank",rel:"noopener noreferrer"},"Create Security Group",-1)),e[26]||(e[26]=s(" wizard with the following parameters and defaults. This creates your ")),t(l),e[27]||(e[27]=s(" proxy security group to allow MQTT clients and SSH access."))]),e[77]||(e[77]=r('<div class="hint-container note"><p class="hint-container-title">Check your selected region</p><p>Make sure you have selected the desired region, ex: <code>US East (N. Virginia) us-east-1</code>.</p></div><ul><li>Name: <code>my-zilla-iot-proxy-sg</code></li><li>VPC: <code>my-zilla-iot-proxy-vpc</code></li><li>Description: <code>MQTT clients and SSH access</code></li><li>Add Inbound Rule <ul><li>Type: <code>CUSTOM TCP</code></li><li>Port Range: <code>8883</code></li><li>Source type: <code>Anywhere-IPv4</code></li></ul></li><li>Add Inbound Rule <ul><li>Type: <code>SSH</code></li><li>Source type: <code>My IP</code></li></ul></li><li>Add Outbound Rule (if not exists) <ul><li>Type: <code>All traffic</code></li><li>Destination: <code>Anywhere-IPv4</code></li></ul></li><li>Create the Security Group</li></ul><div class="hint-container warning"><p class="hint-container-title">Check your network settings</p><p>Your IP may be different when you SSH into the EC2 instance. VPNs and other networking infrastructure may cause the <code>My IP</code> inbound rule to fail. Instead, you can use one of the other ways AWS provides to execute commands in an EC2 instance.</p></div><h3 id="create-the-iam-security-role" tabindex="-1"><a class="header-anchor" href="#create-the-iam-security-role"><span>Create the IAM security role</span></a></h3>',4)),i("blockquote",null,[i("p",null,[e[28]||(e[28]=s("This creates an IAM security role to enable the required AWS services for the ")),t(l),e[29]||(e[29]=s(" proxies."))])]),e[78]||(e[78]=r(`<p>Navigate to the <a href="https://console.aws.amazon.com/iamv2/home#/roles/create" target="_blank" rel="noopener noreferrer">Create role</a> form and fill out the form with the following details:</p><ul><li><p>Region: <code>Global</code></p></li><li><p>Trusted Entity Type: <code>AWS Service</code></p></li><li><p>Choose a use case: <code>EC2</code></p></li><li><p>Add Permissions policies</p><div class="language-text" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>AWSCertificateManagerReadOnly</span></span>
<span class="line"><span>AmazonSSMManagedInstanceCore</span></span></code></pre></div></li><li><p>Role Name:</p><div class="language-text" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>my-zilla-iot-role</span></span></code></pre></div></li></ul><p>Click <code>Create role</code></p><p>Open the newly created role</p><ul><li><p>Use the <code>Add permissions</code> &gt; <code>Create Inline Policy</code> action from the dropdown</p></li><li><p>JSON Summary</p><div class="language-json" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">{</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">  &quot;Version&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;2012-10-17&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">  &quot;Statement&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">    {</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">      &quot;Sid&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;VisualEditor0&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">      &quot;Effect&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">&quot;Allow&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">      &quot;Action&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">        &quot;secretsmanager:GetSecretValue&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">        &quot;secretsmanager:DescribeSecret&quot;</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">      ],</span></span>
<span class="line"><span style="--shiki-light:#0451A5;--shiki-dark:#9CDCFE;">      &quot;Resource&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">: [</span></span>
<span class="line"><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">        &quot;arn:aws:secretsmanager:*:*:secret:&lt;TLS certificate private key secret name&gt;*&quot;</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">,</span></span>
<span class="line"><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">        &quot;arn:aws:secretsmanager:*:*:secret:&lt;SASL/SCRAM auth secret name&gt;*&quot;</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">      ]</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">    }</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">  ]</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">}</span></span></code></pre></div></li></ul><div class="hint-container info"><p class="hint-container-title">If you used a different secret name.</p><p>The IAM role Inline policy uses the Secrets Manager ARN regex pattern <code>arn:aws:secretsmanager:*:*:secret:&lt;Secret Name&gt;*</code>. Make sure you replace the resources listed with the appropriate patterns.</p></div><ul><li><p>Name</p><div class="language-text" data-highlighter="shiki" data-ext="text" data-title="text" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span>MyZillaIotProxySecretsManagerRead</span></span></code></pre></div></li></ul><h2 id="subscribe-via-aws-marketplace" tabindex="-1"><a class="header-anchor" href="#subscribe-via-aws-marketplace"><span>Subscribe via AWS Marketplace</span></a></h2><p>The <a href="https://aws.amazon.com/marketplace/pp/prodview-jshnzslazfm44" target="_blank" rel="noopener noreferrer">Zilla Plus for Amazon MSK</a>) is available through the AWS Marketplace. You can skip this step if you have already subscribed to Zilla Plus for Amazon MSK via the AWS Marketplace.</p><p>To get started, visit the Proxy&#39;s Marketplace <a href="https://aws.amazon.com/marketplace/pp/prodview-jshnzslazfm44" target="_blank" rel="noopener noreferrer">Product Page</a> and <code>Subscribe</code> to the offering. You should now see <code>Zilla Plus for Amazon MSK</code> listed in your <a href="https://console.aws.amazon.com/marketplace" target="_blank" rel="noopener noreferrer">AWS Marketplace</a> subscriptions.</p><h2 id="deploy-the-iot-ingest-and-control-mqtt-broker" tabindex="-1"><a class="header-anchor" href="#deploy-the-iot-ingest-and-control-mqtt-broker"><span>Deploy the IoT Ingest and Control MQTT Broker</span></a></h2><blockquote><p>This initiates deployment of the Zilla Plus for Amazon MSK stack via CloudFormation.</p></blockquote><p>Navigate to your <a href="https://console.aws.amazon.com/marketplace" target="_blank" rel="noopener noreferrer">AWS Marketplace</a> subscriptions and select <code>Zilla Plus for Amazon MSK</code> to show the manage subscription page.</p><ul><li>From the <code>Agreement</code> section &gt; <code>Actions</code> menu &gt; select <code>Launch CloudFormation stack</code></li><li>Select the <code>CloudFormation Template</code> &gt; <code>IoT Ingest and Control</code> fulfillment option</li><li>Make sure you have selected the desired region selected, such as <code>us-east-1</code></li><li>Click <code>Continue to Launch</code><ul><li>Choose the action <code>Launch CloudFormation</code></li></ul></li></ul><p>Click <code>Launch</code> to complete the <code>Create stack</code> wizard with the following details:</p><h3 id="step-1-create-stack" tabindex="-1"><a class="header-anchor" href="#step-1-create-stack"><span>Step 1. Create Stack</span></a></h3><ul><li>Prepare template: <code>Template is ready</code></li><li>Specify template: <code>Amazon S3 URL</code><ul><li>Amazon S3 URL: <code>(auto-filled)</code></li></ul></li></ul><h3 id="step-2-specify-stack-details" tabindex="-1"><a class="header-anchor" href="#step-2-specify-stack-details"><span>Step 2. Specify stack details</span></a></h3>`,18)),t(d,{id:"524",data:[{id:"Stack name"}]},{title0:a(({value:n,isActive:o})=>e[30]||(e[30]=[s("Stack name")])),tab0:a(({value:n,isActive:o})=>e[31]||(e[31]=[i("div",{class:"language-text","data-highlighter":"shiki","data-ext":"text","data-title":"text",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",null,"my-zilla-iot-proxy")])])])],-1)])),_:1}),e[79]||(e[79]=i("p",null,"Parameters:",-1)),i("ul",null,[e[40]||(e[40]=r("<li>Network Configuration <ul><li>VPC: <code>my-zilla-iot-proxy-vpc</code></li><li>Subnets: <code>my-zilla-iot-proxy-subnet-public-1a</code> <code>my-zilla-iot-proxy-subnet-public-1b</code></li></ul></li><li>Amazon MSK Configuration <ul><li>Access Credentials Secret ARN: <code>&lt;my-zilla-iot-access-secret secret ARN&gt;</code> *1</li><li>Bootstrap Servers: <code>&lt;my-zilla-iot-msk-cluster bootstrap servers&gt;</code></li><li>Kafka Topics: <ul><li>messages: <code>mqtt-messages</code></li><li>retained: <code>mqtt-retained</code></li><li>sessions: <code>mqtt-sessions</code></li></ul></li></ul></li><li>Zilla Plus Configuration <ul><li>Instance count: <code>2</code></li><li>Instance type: <code>t3.small</code> *2</li><li>Role: <code>my-zilla-iot-role</code></li><li>Security Groups: <code>my-zilla-iot-proxy-sg</code></li><li>Public Port: <code>8883</code></li><li>Public Wildcard DNS: <code>*.example.aklivity.io</code> *3</li><li>Public TLS Certificate Key: <code>&lt;TLS certificate private key secret ARN&gt;</code> *4</li><li>Key pair for SSH access: <code>my-key-pair</code> *5</li></ul></li>",3)),i("li",null,[e[39]||(e[39]=s("*Configuration Reference ")),i("ol",null,[e[35]||(e[35]=i("li",null,[s("This is the ARN for the secret created in the "),i("a",{href:"#create-a-secret-with-sasl-scram-authentication-params"},"Create a Secret with SASL/SCRAM authentication params"),s(" step of this guide.")],-1)),e[36]||(e[36]=i("li",null,"Consider the network throughput characteristics of the AWS instance type as that will impact the upper bound on network performance.",-1)),e[37]||(e[37]=i("li",null,[s("Replace with your own custom wildcard DNS pattern mentioned in the "),i("a",{href:"#prerequisites"},"Prerequisites"),s(" of this guide.")],-1)),e[38]||(e[38]=i("li",null,[s("This is the ARN of the created secret for the signed certificate's private key mentioned in the "),i("a",{href:"#prerequisites"},"Prerequisites"),s(" of this guide.")],-1)),i("li",null,[e[33]||(e[33]=s("Follow the ")),t(h,{to:"/solutions/how-tos/aws-services/create-key-pair.html"},{default:a(()=>e[32]||(e[32]=[s("Create Key Pair")])),_:1}),e[34]||(e[34]=s(" guide to create a new key pair to access EC2 instances via SSH."))])])])]),e[80]||(e[80]=i("h3",{id:"step-3-configure-stack-options-use-defaults",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#step-3-configure-stack-options-use-defaults"},[i("span",null,[s("Step 3. Configure stack options: "),i("code",null,"(use defaults)")])])],-1)),e[81]||(e[81]=i("h3",{id:"step-4-review",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#step-4-review"},[i("span",null,"Step 4. Review")])],-1)),e[82]||(e[82]=i("p",null,[s("Confirm the stack details are correct and "),i("code",null,"Submit"),s(" to start the CloudFormation deploy.")],-1)),i("div",b,[e[47]||(e[47]=i("p",{class:"hint-container-title"},"Info",-1)),i("p",null,[e[41]||(e[41]=s("When your ")),t(l),e[42]||(e[42]=s(" proxy is ready, the ")),e[43]||(e[43]=i("a",{href:"https://console.aws.amazon.com/cloudformation",target:"_blank",rel:"noopener noreferrer"},"CloudFormation console",-1)),e[44]||(e[44]=s(" will show ")),e[45]||(e[45]=i("code",null,"CREATE_COMPLETE",-1)),e[46]||(e[46]=s(" for the newly created stack."))])]),e[83]||(e[83]=i("h3",{id:"configure-global-dns",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#configure-global-dns"},[i("span",null,"Configure Global DNS")])],-1)),i("blockquote",null,[i("p",null,[e[48]||(e[48]=s("This enables MQTT clients to connect to the ")),t(l),e[49]||(e[49]=s(" proxy via your custom DNS wildcard domain."))])]),e[84]||(e[84]=r(`<p>When using a wildcard DNS name for your own domain, such as <code>*.example.aklivity.io</code> then the DNS entries are setup in your DNS provider.</p><p>Navigate to the <a href="https://console.aws.amazon.com/cloudformation" target="_blank" rel="noopener noreferrer">CloudFormation console</a>. Then select the <code>my-zilla-iot-proxy</code> stack to show the details.</p><p>In the stack <code>Outputs</code> tab, find the public DNS name of the <code>NetworkLoadBalancer</code>. You need to create a <code>CNAME</code> record mapping your public DNS wildcard pattern to the public DNS name of the Network Load Balancer.</p><div class="hint-container info"><p class="hint-container-title">Info</p><p>You might prefer to use an Elastic IP address for each NLB public subnet, providing DNS targets for your <code>CNAME</code> record that can remain stable even after restarting the stack.</p><p>For testing purposes you can edit your local <code>/etc/hosts</code> file instead of updating your DNS provider.</p></div><h2 id="verify-mqtt-client-connectivity" tabindex="-1"><a class="header-anchor" href="#verify-mqtt-client-connectivity"><span>Verify MQTT Client Connectivity</span></a></h2><p>We need to verify that an MQTT client can publish and subscribe to topics and ensure the messages get routed through your Kafka cluster.</p><h3 id="connect-with-an-mqtt-client" tabindex="-1"><a class="header-anchor" href="#connect-with-an-mqtt-client"><span>Connect with an MQTT Client</span></a></h3><blockquote><p>This verifies MQTT client connectivity to your Kafka cluster via the IoT Ingest and Control MQTT Broker.</p></blockquote><p>We can now verify that the MQTT client can successfully communicate with your Kafka cluster.</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>Replace these TLS server names accordingly for your own custom wildcard DNS pattern.</p></div><h3 id="subscribe-to-a-topic" tabindex="-1"><a class="header-anchor" href="#subscribe-to-a-topic"><span>Subscribe to a topic</span></a></h3><p>Using <a href="https://hub.docker.com/_/eclipse-mosquitto" target="_blank" rel="noopener noreferrer">eclipse-mosquitto</a> subscribe to the <code>zilla</code> topic.</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">docker</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> run</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> -it</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> --rm</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> eclipse-mosquitto</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">mosquitto_sub </span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">--url</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> mqtts://mqtt.example.aklivity.io/zilla</span></span></code></pre></div><h3 id="publish-to-a-topic" tabindex="-1"><a class="header-anchor" href="#publish-to-a-topic"><span>Publish to a topic</span></a></h3><p>In a separate session, publish a message on the <code>zilla</code> topic.</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">docker</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> run</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> -it</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> --rm</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> eclipse-mosquitto</span><span style="--shiki-light:#EE0000;--shiki-dark:#D7BA7D;"> \\</span></span>
<span class="line"><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">mosquitto_pub </span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;">--url</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> mqtts://mqtt.example.aklivity.io/zilla</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> --message</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> &#39;Hello, world&#39;</span></span></code></pre></div><p>You should see the <code>Hello, world</code> message printed by the subscriber.</p><h2 id="verify-the-zilla-proxy-service" tabindex="-1"><a class="header-anchor" href="#verify-the-zilla-proxy-service"><span>Verify the Zilla proxy Service</span></a></h2><blockquote><p>This checks that the services and networking were properly configured. These checks aren&#39;t necessary if the service is running as expected.</p></blockquote><p>Navigate to the <a href="https://console.aws.amazon.com/ec2/home#Instances:instanceState=running" target="_blank" rel="noopener noreferrer">EC2 running instances dashboard.</a></p><div class="hint-container note"><p class="hint-container-title">Check your selected region</p><p>Make sure you have selected the desired region, ex: <code>US East (N. Virginia) us-east-1</code>.</p></div>`,21)),i("p",null,[e[50]||(e[50]=s("Select either of the ")),t(l),e[51]||(e[51]=s(" proxies launched by the CloudFormation template to show the details."))]),e[85]||(e[85]=r('<div class="hint-container info"><p class="hint-container-title">Info</p><p>They each have an IAM Role name starting with <code>my-zilla-iot-role</code>.</p></div><p>Find the <code>Public IPv4 Address</code> and then SSH into the instance.</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#000000;--shiki-dark:#D4D4D4;--shiki-light-bg:#FFFFFF;--shiki-dark-bg:#1E1E1E;"><pre class="shiki shiki-themes light-plus dark-plus vp-code"><code><span class="line"><span style="--shiki-light:#795E26;--shiki-dark:#DCDCAA;">ssh</span><span style="--shiki-light:#0000FF;--shiki-dark:#569CD6;"> -i</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;"> ~/.ssh/</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">&lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">key-pair.ce</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">r&gt; </span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">ec2-user@</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">&lt;</span><span style="--shiki-light:#A31515;--shiki-dark:#CE9178;">instance-public-ip-addres</span><span style="--shiki-light:#000000;--shiki-dark:#D4D4D4;">s&gt;</span></span></code></pre></div><p>After logging in via SSH, check the status of the <code>zilla-plus</code> system service.</p>',4)),t(c,{id:"785",data:[{id:"Service is running"},{id:"Check Ports"},{id:"Check Zilla Logs"},{id:"Check Cloud Init Logs"}]},{title0:a(({value:n,isActive:o})=>e[52]||(e[52]=[s("Service is running")])),title1:a(({value:n,isActive:o})=>e[53]||(e[53]=[s("Check Ports")])),title2:a(({value:n,isActive:o})=>e[54]||(e[54]=[s("Check Zilla Logs")])),title3:a(({value:n,isActive:o})=>e[55]||(e[55]=[s("Check Cloud Init Logs")])),tab0:a(({value:n,isActive:o})=>e[56]||(e[56]=[i("p",null,[s("Verify that the "),i("code",null,"zilla-plus"),s(" service is active and logging output similar to that shown below.")],-1),i("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash","data-title":"bash",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#795E26","--shiki-dark":"#DCDCAA"}},"systemctl"),i("span",{style:{"--shiki-light":"#A31515","--shiki-dark":"#CE9178"}}," status"),i("span",{style:{"--shiki-light":"#A31515","--shiki-dark":"#CE9178"}}," zilla-plus.service")])])])],-1),i("div",{class:"language-output","data-highlighter":"shiki","data-ext":"output","data-title":"output",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",null,"zilla-plus.service - Zilla Plus")]),s(`
`),i("span",{class:"line"},[i("span",null,"   Loaded: loaded (/etc/systemd/system/zilla-plus.service; enabled; vendor preset: disabled)")]),s(`
`),i("span",{class:"line"},[i("span",null,"   Active: active (running) since...")])])])],-1)])),tab1:a(({value:n,isActive:o})=>e[57]||(e[57]=[i("p",null,[s("Check for the active ports with "),i("code",null,"netstat"),s(".")],-1),i("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash","data-title":"bash",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#795E26","--shiki-dark":"#DCDCAA"}},"netstat"),i("span",{style:{"--shiki-light":"#0000FF","--shiki-dark":"#569CD6"}}," -ntlp")])])])],-1),i("div",{class:"language-output","data-highlighter":"shiki","data-ext":"output","data-title":"output",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",null,"tcp6    0    0 :::9092    :::*    LISTEN    1726/.zpm/image/bin")])])])],-1)])),tab2:a(({value:n,isActive:o})=>e[58]||(e[58]=[i("p",null,[s("You can get an stdout dump of the "),i("code",null,"zilla-plus.service"),s(" using "),i("code",null,"journalctl"),s(".")],-1),i("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash","data-title":"bash",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#795E26","--shiki-dark":"#DCDCAA"}},"journalctl"),i("span",{style:{"--shiki-light":"#0000FF","--shiki-dark":"#569CD6"}}," -e"),i("span",{style:{"--shiki-light":"#0000FF","--shiki-dark":"#569CD6"}}," -u"),i("span",{style:{"--shiki-light":"#A31515","--shiki-dark":"#CE9178"}}," zilla-plus.service"),i("span",{style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4"}}," | "),i("span",{style:{"--shiki-light":"#795E26","--shiki-dark":"#DCDCAA"}},"tee"),i("span",{style:{"--shiki-light":"#0000FF","--shiki-dark":"#569CD6"}}," -a"),i("span",{style:{"--shiki-light":"#A31515","--shiki-dark":"#CE9178"}}," /tmp/zilla.log")])])])],-1),i("div",{class:"language-output","data-highlighter":"shiki","data-ext":"output","data-title":"output",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",null,"systemd[1]: Started zilla-plus.service - Zilla Plus.")]),s(`
`),i("span",{class:"line"},[i("span",null,"...")])])])],-1)])),tab3:a(({value:n,isActive:o})=>e[59]||(e[59]=[i("p",null,[s("All output from cloud-init is captured by default to "),i("code",null,"/var/log/cloud-init-output.log"),s(". There shouldn't be any errors in this log.")],-1),i("div",{class:"language-bash","data-highlighter":"shiki","data-ext":"bash","data-title":"bash",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#795E26","--shiki-dark":"#DCDCAA"}},"cat"),i("span",{style:{"--shiki-light":"#A31515","--shiki-dark":"#CE9178"}}," /var/log/cloud-init-output.log")])])])],-1),i("div",{class:"language-output","data-highlighter":"shiki","data-ext":"output","data-title":"output",style:{"--shiki-light":"#000000","--shiki-dark":"#D4D4D4","--shiki-light-bg":"#FFFFFF","--shiki-dark-bg":"#1E1E1E"}},[i("pre",{class:"shiki shiki-themes light-plus dark-plus vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",null,"Cloud-init v. 22.2.2 running 'init'...")])])])],-1)])),_:1}),e[86]||(e[86]=i("h2",{id:"conclusion",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#conclusion"},[i("span",null,"Conclusion")])],-1)),i("p",null,[e[61]||(e[61]=s("You have successfully deployed the ")),e[62]||(e[62]=i("a",{href:"https://aws.amazon.com/marketplace/pp/prodview-jshnzslazfm44",target:"_blank",rel:"noopener noreferrer"},"Zilla Plus for Amazon MSK",-1)),e[63]||(e[63]=s(" IoT Ingest and Control MQTT Broker. Instructions on how to Monitor and Upgrade your ")),t(l),e[64]||(e[64]=s(" proxy can be found in the ")),t(h,{to:"/solutions/how-tos/aws-services/manage-cloudformation-stack.html"},{default:a(()=>e[60]||(e[60]=[s("managing a cloudformation stack")])),_:1}),e[65]||(e[65]=s(" section."))])])}const A=u(m,[["render",C],["__file","iot-ingest-control.html.vue"]]),E=JSON.parse('{"path":"/solutions/how-tos/amazon-msk/iot-ingest-control.html","title":"Amazon MSK IoT Ingest and Control","lang":"en-US","frontmatter":{"icon":"aky-zilla-plus","description":"The IoT Ingest and Control MQTT Broker that lets clients publish messages and subscribe to topics proxied to Kafka topics in your Amazon MSK cluster.","gitInclude":["../../_partials/iot-ingest-control/prerequisites.md","../../_partials/zilla-plus-proxy/msk-access-secret.md","../../_partials/iot-ingest-control/aws-resources.md","../../_partials/iot-ingest-control/cf-stack/s1-launch.md","../../_partials/iot-ingest-control/cf-stack/s3-create.md","../../_partials/iot-ingest-control/configure-global-dns.md","../../_partials/iot-ingest-control/verify-mqtt-client-connectivity.md","../../_partials/zilla-plus-proxy/verify-zilla-plus-proxy-service.md"],"head":[["meta",{"property":"og:url","content":"https://docs.aklivity.io/zilla-docs/next/solutions/how-tos/amazon-msk/iot-ingest-control.html"}],["meta",{"property":"og:site_name","content":"Documentation"}],["meta",{"property":"og:title","content":"Amazon MSK IoT Ingest and Control"}],["meta",{"property":"og:description","content":"The IoT Ingest and Control MQTT Broker that lets clients publish messages and subscribe to topics proxied to Kafka topics in your Amazon MSK cluster."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Amazon MSK IoT Ingest and Control\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Overview","slug":"overview","link":"#overview","children":[]},{"level":2,"title":"Prerequisites","slug":"prerequisites","link":"#prerequisites","children":[{"level":3,"title":"AWS services used","slug":"aws-services-used","link":"#aws-services-used","children":[]}]},{"level":2,"title":"Create the Amazon MSK cluster","slug":"create-the-amazon-msk-cluster","link":"#create-the-amazon-msk-cluster","children":[{"level":3,"title":"Create a Secret with SASL/SCRAM authentication params","slug":"create-a-secret-with-sasl-scram-authentication-params","link":"#create-a-secret-with-sasl-scram-authentication-params","children":[]}]},{"level":2,"title":"Zilla proxy AWS resources","slug":"zilla-proxy-aws-resources","link":"#zilla-proxy-aws-resources","children":[{"level":3,"title":"Create the VPC","slug":"create-the-vpc","link":"#create-the-vpc","children":[]},{"level":3,"title":"Create the security group","slug":"create-the-security-group","link":"#create-the-security-group","children":[]},{"level":3,"title":"Create the IAM security role","slug":"create-the-iam-security-role","link":"#create-the-iam-security-role","children":[]}]},{"level":2,"title":"Subscribe via AWS Marketplace","slug":"subscribe-via-aws-marketplace","link":"#subscribe-via-aws-marketplace","children":[]},{"level":2,"title":"Deploy the IoT Ingest and Control MQTT Broker","slug":"deploy-the-iot-ingest-and-control-mqtt-broker","link":"#deploy-the-iot-ingest-and-control-mqtt-broker","children":[{"level":3,"title":"Step 1. Create Stack","slug":"step-1-create-stack","link":"#step-1-create-stack","children":[]},{"level":3,"title":"Step 2. Specify stack details","slug":"step-2-specify-stack-details","link":"#step-2-specify-stack-details","children":[]},{"level":3,"title":"Step 3. Configure stack options: (use defaults)","slug":"step-3-configure-stack-options-use-defaults","link":"#step-3-configure-stack-options-use-defaults","children":[]},{"level":3,"title":"Step 4. Review","slug":"step-4-review","link":"#step-4-review","children":[]},{"level":3,"title":"Configure Global DNS","slug":"configure-global-dns","link":"#configure-global-dns","children":[]}]},{"level":2,"title":"Verify MQTT Client Connectivity","slug":"verify-mqtt-client-connectivity","link":"#verify-mqtt-client-connectivity","children":[{"level":3,"title":"Connect with an MQTT Client","slug":"connect-with-an-mqtt-client","link":"#connect-with-an-mqtt-client","children":[]},{"level":3,"title":"Subscribe to a topic","slug":"subscribe-to-a-topic","link":"#subscribe-to-a-topic","children":[]},{"level":3,"title":"Publish to a topic","slug":"publish-to-a-topic","link":"#publish-to-a-topic","children":[]}]},{"level":2,"title":"Verify the Zilla proxy Service","slug":"verify-the-zilla-proxy-service","link":"#verify-the-zilla-proxy-service","children":[]},{"level":2,"title":"Conclusion","slug":"conclusion","link":"#conclusion","children":[]}],"readingTime":{"minutes":2.63,"words":788},"filePathRelative":"solutions/how-tos/amazon-msk/iot-ingest-control.md"}');export{A as comp,E as data};
